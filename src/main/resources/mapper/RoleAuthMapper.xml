<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.haustoj.dao.RoleAuthDao">
    <resultMap id="RoleAuthsVoMap" type="com.example.haustoj.pojo.vo.RoleAuthsVo">
        <result column="role_id" property="id"/>
        <result column="name" property="name"/>
        <result column="description" property="description"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <collection property="authList" ofType="com.example.haustoj.pojo.po.Role">
            <id column="auth_id" property="id"/>
            <result column="auth_name" property="name"/>
            <result column="auth_description" property="description"/>
            <result column="auth_permission" property="permission"/>
            <result column="auth_status" property="status"/>
            <result column="auth_create_time" property="createTime"/>
            <result column="auth_update_time" property="updateTime"/>
        </collection>
    </resultMap>
    <select id="getRoleAuths" resultMap="RoleAuthsVoMap">
        SELECT
            r.id as role_id,
            r.name as name,
            r.description as description,
            r.status as status,
            r.create_time as create_time,
            r.update_time as update_time,
            a.id as auth_id,
            a.name as auth_name,
            a.description as auth_description,
            a.permission as auth_permission,
            a.status as auth_status,
            a.create_time as auth_create_time,
            a.update_time as auth_update_time
        FROM role r
        LEFT OUTER JOIN
            role_auth ra
        ON
            r.id = ra.role_id
        LEFT JOIN
            auth a
        ON
            a.id = ra.auth_id
    </select>
    <select id="getAuthsByRoleId" resultType="com.example.haustoj.pojo.po.Auth">
        SELECT
            a.id as id,
            a.name as name,
            a.description as description,
            a.permission as permission,
            a.status as status,
            a.create_time as create_time,
            a.update_time as update_time
        FROM auth a
        LEFT JOIN
            role_auth ra
        ON
            a.id = ra.auth_id
        WHERE
            ra.role_id = #{roleId}
    </select>
</mapper>